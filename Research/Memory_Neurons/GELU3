INIT
    prototype[D]          // EMA memory, one scalar per neuron
    ready = false

    alpha[D] ∈ (0, 1)     // suppression strength per neuron, learnable
    d ∈ (0, 1)            // EMA decay per neuron, learnable

INPUT
    x:
        B = batch size
        T = sequence length
        D = feature / hidden dimension

    There are B × T tokens total

RUN
    if not ready:
        prototype = mean(x over B and T)
        ready = true
        return GELU(x)

    for b in 1..B:
        for t in 1..T:
            for k in 1..D:
                similarity = sign(x[b,t,k] * prototype[k])
                scale = 1 - alpha[k] * similarity
                y[b,t,k] = GELU(x[b,t,k] * scale)

    batch_mean = mean(x over B and T)
    prototype =
        d * prototype +
        (1 - d) * batch_mean

    return y